# How to set up a data processing + analysis workflow with Fragpipe and Fragpipe Analyst

This tutorial will guide you through the steps needed to set up a data processing and analysis workflow for DIA data using Fragpipe and Fragpipe Analyst. Make sure you have Fragpipe installed on your computer before proceeding. You can download it from https://fragpipe.nesvilab.org/. Fragpipe Analyst will **not** work with any data processed with other software, so it is essential to use Fragpipe for this workflow. We'll start with DIA data processing in Fragpipe first. Let's begin!

## Table of Contents

1.  [Prerequisites](#prerequisites)
2.  [Part 1: Processing DIA Data with Fragpipe](#how-to-use-fragpipe-to-process-dia-data)
3.  [Part 2: Analyzing Data with Fragpipe Analyst](#how-to-use-fragpipe-analyst-to-analyze-your-processed-data)

------------------------------------------------------------------------

## Prerequisites {#prerequisites}

Before starting this tutorial, ensure you have:

### System Requirements

-   **Administrator access** to your computer (required to run Fragpipe)
-   **Minimum 16 GB RAM** required. 32 GB or more is recommended for large datasets
-   **Sufficient disk space** at least 3x the size of your raw data files
-   (you will not have to worry about specs if you are remotely accessing a high-performance computing server)

### Required Files

-   **Raw data files** (.raw format from your mass spectrometer)
-   **FASTA file** for your organism(s) of interest, OR know the species name to download directly from Fragpipe

### Software

-   **Fragpipe** installed on your computer (download from https://fragpipe.nesvilab.org/)
-   Fragpipe will prompt you to download additional components (MSFragger, DIA-NN, Python) during setup

### Important Notes

‚è±Ô∏è **Estimated time:** Data processing typically takes 30-120 minutes depending on the number of files and your computer's specifications.

------------------------------------------------------------------------

## How to use Fragpipe to process DIA data {#how-to-use-fragpipe-to-process-dia-data}

Step 0: Start by locating the Fragpipe shortcut on your desktop. It should look like this:

![Fragpipe desktop shortcut](./screenshots/Step_0.png)

Step 1: Right-click the shortcut and select **"Run as administrator"**.

‚ö†Ô∏è **Important:** Fragpipe must be run as administrator or it will not function properly.

![Running Fragpipe as administrator](./screenshots/Step_1.png)

Step 1 Alternative: If you can't find the shortcut on your desktop, press the Windows key to search for Fragpipe and click on **"Run as administrator"**.

![Searching for Fragpipe in Windows](./screenshots/Step_1_Alt.png)

Step 2: The program should open and greet you with this screen. You should be on the **Config** tab. It should look something like this:

![Fragpipe Config tab](./screenshots/Step_2.png)

Step 3: Pay attention to this top part of the menu. You may need to download some additional software tools for this workflow, so click **Download / Update**.

![MSFragger download section](./screenshots/Step_3.png)

Step 4: A separate menu will pop up, asking for your credentials to obtain an academic license for MSFragger. Enter your name, email, and institution, agree to the terms and conditions, then click **Send Verification Email**. Check your email (including spam folder) for the verification code and enter it in the box. When you are done, click **Download**.

üí° **Tip:** This is a one-time registration. The verification email usually arrives within a few minutes.

![MSFragger registration](./screenshots/Step_4.png)

Step 5: Scroll down to the next section on the menu. Fragpipe may already be bundled with DIA-NN, but if you cannot see "DIA-NN" with a version number listed, click **Download**.

![DIA-NN download section](./screenshots/Step_5.png)

Step 6: Similarly, check if Python is listed with a version number. If you cannot see it, click **Download** as well. Python is required for generating reports.

![Python download section](./screenshots/Step_6.png)

‚úÖ **Checkpoint:** Before proceeding, verify that all three components show version numbers: - MSFragger - DIA-NN\
- Python

Step 7: Navigate to the **Workflow** tab. You should be on the Workflow tab now. It should look similar to this:

![Workflow tab](./screenshots/Step_7.png)

Step 8: Make sure to select **DIA_Umpire_SpecLib_Quant** as your workflow. This is the recommended workflow for DIA quantification with spectral library generation.

üí° **Tip:** The default settings work well for most users. Advanced users who need to adjust parameters (enzyme specificity, mass tolerances, etc.) can refer to the [Fragpipe documentation](https://fragpipe.nesvilab.org/docs/tutorial_dia.html).

![Workflow selection](./screenshots/Step_8.png)

Step 9: Navigate to the **Input** tab. Here you can add your .raw files generated by the mass spectrometer by clicking the **Add files** button. You can select multiple files at once.

![Input tab](./screenshots/Step_9.png)

Step 10: After your files have been added, you should see them listed here like this. The total count of .raw files is displayed at the bottom of the file list.

![Files added to input list](./screenshots/Step_10.png)

Step 11: Select all of the files by clicking on one file and then pressing **Ctrl + A** on your keyboard. All files should be highlighted now. Then click **Set DIA** to specify that these are DIA files.

‚ö†Ô∏è **Important:** This workflow only works with DIA data. Do not use it for DDA data.

![Selecting all files](./screenshots/Step_11.png)

Step 12: After clicking **Set DIA**, you should see that the **Data Type** column for all your files now shows "DIA" like this:

![Files labeled as DIA](./screenshots/Step_12.png)

Step 13: **‚ö†Ô∏è CRITICAL STEP:** You need to name the experimental condition for each file and assign bioreplicate numbers.

**How to assign experiments and bioreplicates:** - **Experiment column:** Enter the condition name (e.g., "Control", "Treatment", "High_Dose") - **Bioreplicate column:** Enter a number for each replicate (e.g., 1, 2, 3) - Files from the same condition should have the **same Experiment name** but **different Bioreplicate numbers**

**Example:** - Control_rep1.raw ‚Üí Experiment: "Control", Bioreplicate: 1 - Control_rep2.raw ‚Üí Experiment: "Control", Bioreplicate: 2\
- Control_rep3.raw ‚Üí Experiment: "Control", Bioreplicate: 3 - Treatment_rep1.raw ‚Üí Experiment: "Treatment", Bioreplicate: 1 - Treatment_rep2.raw ‚Üí Experiment: "Treatment", Bioreplicate: 2 - Treatment_rep3.raw ‚Üí Experiment: "Treatment", Bioreplicate: 3

‚ö†Ô∏è **Common mistakes to avoid:** - Using different names for the same condition ("Control" vs "control" vs "Ctrl") - Assigning the same bioreplicate number to different samples in the same condition - Leaving experiment or bioreplicate fields blank

This information is **essential** for Fragpipe Analyst to perform statistical comparisons correctly.

![Assigning experiments and bioreplicates](./screenshots/Step_13.png)

Step 14: After you have named all of your experimental conditions and assigned bioreplicate numbers, your Input tab should look something like this:

‚úÖ **Checkpoint - Verify before proceeding:** - \[ \] All files have an Experiment name - \[ \] All files have a Bioreplicate number\
- \[ \] Replicates of the same condition have the same Experiment name - \[ \] Replicates of the same condition have different Bioreplicate numbers - \[ \] Experiment names are spelled consistently (case-sensitive)

![Completed input configuration](./screenshots/Step_14.png)

Step 15: Navigate to the **Database** tab. Here you need to add your FASTA file:

**Choose one option:** - Click **Add** if you already have a FASTA file saved on your computer - Click **Download** if you need to download a FASTA file from UniProt (works best for single-species samples)

üí° **Tip:** For multi-species samples or custom databases, use the **Add** button with a pre-prepared FASTA file.

![Database tab](./screenshots/Step_15.png)

Step 16: After adding your FASTA file, you should see it listed in the database path. You also need to click **Add decoys** to generate decoy sequences.

‚ö†Ô∏è **Important:** Decoy sequences are essential for false discovery rate (FDR) calculation. Always add decoys before running the analysis.

![FASTA file added](./screenshots/Step_16.png)

Step 17: Navigate to the **Run** tab. Click **Browse** to select your output directory where results will be saved. Make sure you have sufficient disk space (at least 3x your raw data size). Then click the **Run** button to start processing your data.

‚è±Ô∏è **Expected time:** Processing typically takes 30-120 minutes depending on the number of files and your computer specifications.

![Run tab](./screenshots/Step_17.png)

Step 18: Before the run starts, a pop-up window may appear asking you to convert the .raw files to .mzML files. Click **Yes** to proceed. Fragpipe will automatically handle the conversion using MSConvert.

![Raw file conversion prompt](./screenshots/Step_18.png)

Step 19: After clicking Run, you should see log messages appearing in the console area. This indicates that the processing has started. You can monitor the progress of your run here. The process will go through several stages including file conversion, database searching, and quantification.

![Processing log messages](./screenshots/Step_19.png)

Step 20: If at any point during the run you see an error message like this, your run has been aborted.

![Error message example](./screenshots/Step_20.png)

**Common issues and solutions:** - **Insufficient disk space:** Free up space and restart - **Incorrect FASTA file:** Verify the file is properly formatted and contains protein sequences - **Corrupted raw files:** Check that your .raw files are complete and not corrupted - **Missing dependencies:** Return to Step 5-6 and verify MSFragger, DIA-NN, and Python are installed - **Memory issues:** Close other programs to free up RAM, or process fewer files at once

üí° **Tip:** Check the log messages above the error for specific details about what went wrong.

------------------------------------------------------------------------

‚úÖ **Success indicators:** When processing completes successfully, you should see: - "DONE" message in the log - Multiple output files in your output directory including: - `combined_protein.tsv` (protein-level results) - `combined_peptide.tsv` (peptide-level results)\
- `diann-output.tsv` (DIA-NN quantification results) - QC report files

------------------------------------------------------------------------

## How to use Fragpipe Analyst to analyze your processed data {#how-to-use-fragpipe-analyst-to-analyze-your-processed-data}